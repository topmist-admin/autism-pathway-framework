# Outputs Dictionary

> **RESEARCH USE ONLY — NOT FOR CLINICAL DECISION-MAKING**
>
> All outputs from this framework are for research and hypothesis generation purposes only.
> They must NOT be used for clinical diagnosis, treatment decisions, or medical advice.
> All findings require independent experimental and clinical validation.

This document describes each output artifact generated by the Autism Pathway Framework, how to interpret the results, and critical limitations to keep in mind.

---

## Table of Contents

1. [Output Overview](#output-overview)
2. [pathway_scores.csv](#pathway_scorescsv)
3. [subtype_assignments.csv](#subtype_assignmentscsv)
4. [figures/summary.png](#figuressummarypng)
5. [report.json](#reportjson)
6. [report.md](#reportmd)
7. [run_metadata.yaml](#run_metadatayaml)
8. [pipeline.log](#pipelinelog)
9. [Validation Gates](#validation-gates)
10. [Interpretation Guardrails](#interpretation-guardrails)
11. [What NOT to Infer](#what-not-to-infer)

---

## Output Overview

All outputs are written to the configured output directory (default: `outputs/demo_run/`).

```
outputs/demo_run/
├── figures/
│   └── summary.png           # Visualization of clustering results
├── pathway_scores.csv        # Sample × Pathway score matrix
├── subtype_assignments.csv   # Cluster assignments with confidence
├── report.json               # Machine-readable summary
├── report.md                 # Human-readable report
├── run_metadata.yaml         # Reproducibility metadata
└── pipeline.log              # Execution log
```

---

## pathway_scores.csv

### Description
Z-score normalized pathway disruption scores for each sample.

### Format
CSV with samples as rows and pathways as columns.

```csv
,SYNAPTIC_TRANSMISSION,CHROMATIN_REMODELING,ION_CHANNEL_REGULATION,...
SAMPLE_001,1.23,-0.45,0.87,...
SAMPLE_002,-0.67,1.89,-0.12,...
```

### Columns

| Column | Type | Description |
|--------|------|-------------|
| (index) | string | Sample identifier |
| [pathway_name] | float | Z-score normalized pathway score |

### How to Interpret

- **Positive scores** (>0): Higher-than-average pathway disruption for this sample
- **Negative scores** (<0): Lower-than-average pathway disruption
- **Magnitude**: Larger absolute values indicate stronger deviation from the cohort mean
- **Units**: Standard deviations from the mean (Z-scores)

### Limitations

- Scores are relative to the cohort analyzed—they do not indicate absolute pathogenicity
- Pathway scores depend on which genes are present in the pathway database
- Missing genes in a pathway will underestimate disruption
- Scores are sensitive to cohort composition (batch effects possible)

### What NOT to Infer

- ❌ "A score of 2.0 means the pathway is pathogenic"
- ❌ "Negative scores mean the pathway is protective"
- ❌ "This sample has disease because of high synaptic score"
- ✅ "This sample shows elevated disruption in synaptic pathways relative to this cohort"

---

## subtype_assignments.csv

### Description
Cluster/subtype assignments for each sample with confidence scores.

### Format

```csv
sample_id,cluster_id,cluster_label,confidence,planted_subtype
SAMPLE_001,0,synaptic,0.92,synaptic
SAMPLE_002,1,chromatin,0.78,chromatin
```

### Columns

| Column | Type | Description |
|--------|------|-------------|
| sample_id | string | Sample identifier |
| cluster_id | int | Numeric cluster ID (0-indexed) |
| cluster_label | string | Biological label based on top pathway |
| confidence | float | GMM posterior probability [0-1] |
| planted_subtype | string | Ground truth (if available in demo data) |

### How to Interpret

- **cluster_id**: Arbitrary numeric identifier for the cluster
- **cluster_label**: Heuristic label based on which pathway has highest mean score in the cluster
- **confidence**: How confident the model is in this assignment
  - >0.9: High confidence
  - 0.7-0.9: Moderate confidence
  - <0.7: Low confidence (sample may be at cluster boundary)

### Limitations

- Cluster labels are heuristic—they are NOT validated biological subtypes
- The number of clusters is determined by BIC, which may over- or under-estimate true subtypes
- Confidence scores reflect model uncertainty, not biological validity
- Clustering is unsupervised—it finds patterns, not necessarily meaningful subtypes

### What NOT to Infer

- ❌ "This patient has synaptic autism"
- ❌ "Cluster 0 patients should receive different treatment"
- ❌ "High confidence means this is definitely the right subtype"
- ✅ "This sample groups with others showing elevated synaptic pathway scores"

---

## figures/summary.png

### Description
Three-panel visualization of clustering results.

### Panels

1. **Left: PCA Projection**
   - 2D projection of samples colored by cluster
   - Shows separation (or overlap) between clusters
   - Axes show % variance explained

2. **Middle: Pathway Heatmap**
   - Samples (columns) ordered by cluster
   - Top 10 variable pathways (rows)
   - Color: Red = high score, Blue = low score

3. **Right: Cluster Distribution**
   - Bar chart of samples per cluster
   - Shows cluster balance/imbalance

### How to Interpret

- **Well-separated clusters in PCA**: Distinct pathway disruption patterns
- **Overlapping clusters**: Samples may not have distinct patterns
- **Heatmap blocks**: Visual confirmation of cluster-pathway associations
- **Uneven distribution**: Some subtypes may be rarer

### Limitations

- PCA shows only 2 dimensions—information is lost
- Visual separation doesn't guarantee biological meaning
- Heatmap shows only top 10 pathways

### What NOT to Infer

- ❌ "Separated clusters = validated subtypes"
- ❌ "Overlapping samples are misclassified"
- ✅ "The data shows some structure in pathway space"

---

## report.json

### Description
Machine-readable summary for programmatic access.

### Schema

```json
{
  "pipeline_name": "demo_run",
  "timestamp": "2024-01-27T10:42:30",
  "seed": 42,
  "input_files": {
    "vcf": "path/to/file.vcf",
    "phenotypes": "path/to/phenotypes.csv",
    "pathways": "path/to/pathways.gmt"
  },
  "summary": {
    "n_variants": 20,
    "n_samples": 50,
    "n_genes": 18,
    "n_pathways": 15,
    "n_clusters": 3
  },
  "clusters": {
    "synaptic": 18,
    "chromatin": 17,
    "ion_channel": 15
  },
  "ground_truth_validation": {
    "adjusted_rand_index": 0.75,
    "ari_threshold_met": true
  },
  "validation_gates": {
    "all_passed": true,
    "summary": "All 3 validation gates PASSED",
    "tests": [
      {
        "name": "Negative Control 1: Label Shuffle",
        "status": "PASS",
        "metric": "mean_null_ARI",
        "value": 0.02,
        "threshold": 0.15,
        "comparison": "<"
      }
    ]
  },
  "disclaimer": "Research use only..."
}
```

### Fields

| Field | Description |
|-------|-------------|
| pipeline_name | Run identifier |
| timestamp | ISO 8601 timestamp |
| seed | Random seed for reproducibility |
| input_files | Paths to input data |
| summary | Counts of variants, samples, genes, pathways, clusters |
| clusters | Sample count per cluster |
| ground_truth_validation | ARI vs planted subtypes (if available) |
| validation_gates | Results from mandatory validation tests |
| disclaimer | Required research-use disclaimer |

---

## report.md

### Description
Human-readable Markdown report for documentation.

### Sections

1. **Header**: Pipeline name, date, seed
2. **Input Summary**: Table of input data counts
3. **Clustering Results**: Number of clusters and distribution
4. **Validation Gates**: Pass/fail status for mandatory tests
5. **Ground Truth Validation**: ARI score if planted subtypes available
6. **Disclaimer**: Research-use notice

### Use Cases

- Include in publications as supplementary material
- Share with collaborators
- Document analysis runs

---

## run_metadata.yaml

### Description
Reproducibility metadata for exact replication.

### Contents

```yaml
run_id: demo_run_20240127_104230
config_file: configs/demo.yaml
timestamp: 2024-01-27T10:42:30
git_commit: abc123
random_seed: 42
input_files:
  vcf: examples/demo_data/demo_variants.vcf
  vcf_hash: a1b2c3d4e5f6
  phenotypes: examples/demo_data/demo_phenotypes.csv
  phenotypes_hash: f6e5d4c3b2a1
  pathways: examples/demo_data/demo_pathways.gmt
  pathways_hash: 1a2b3c4d5e6f
runtime_seconds: 3.4
```

### Purpose

- **Reproducibility**: Re-run with same inputs and parameters
- **Provenance**: Track which data produced which results
- **Auditing**: Verify inputs haven't changed

---

## pipeline.log

### Description
Detailed execution log for debugging and auditing.

### Log Levels

| Level | Meaning |
|-------|---------|
| INFO | Normal progress messages |
| WARNING | Non-fatal issues |
| ERROR | Fatal errors |

### Example

```
2024-01-27 10:42:28 - INFO - Set random seed: 42
2024-01-27 10:42:28 - INFO - Loading input data...
2024-01-27 10:42:28 - INFO - Loaded: 20 variants, 50 samples, 15 pathways
2024-01-27 10:42:28 - INFO - Computing gene burden scores...
```

---

## Validation Gates

The pipeline runs mandatory validation gates to assess clustering quality before results should be trusted.

### Tests Performed

| Test | Purpose | Pass Condition |
|------|---------|----------------|
| **Negative Control 1: Label Shuffle** | Verify clustering doesn't find spurious patterns | Mean ARI < 0.15 |
| **Negative Control 2: Random Gene Sets** | Verify clusters are driven by biological pathways | Mean ARI < 0.15 |
| **Stability Test: Bootstrap** | Verify clusters are robust to resampling | Mean ARI ≥ 0.8 |

### Test Descriptions

#### Negative Control 1: Label Shuffle

Shuffles cluster labels randomly and re-runs clustering 100 times. The clustering should NOT recover the shuffled labels (ARI should be ~0). If clustering CAN recover shuffled labels, it suggests the clusters are artifacts of the method rather than real structure in the data.

- **Metric**: `mean_null_ARI` (average ARI across 100 permutations)
- **Threshold**: < 0.15
- **PASS**: Clustering does not find spurious patterns
- **FAIL**: Method may be producing artifacts

#### Negative Control 2: Random Gene Sets

Replaces biological pathway definitions with random gene sets of the same sizes and re-clusters 100 times. Clustering on random gene sets should NOT recover the original cluster structure. If clustering CAN recover structure with random gene sets, it suggests the results are not driven by meaningful biological pathways.

- **Metric**: `mean_random_ARI` (average ARI across 100 permutations)
- **Threshold**: < 0.15
- **PASS**: Clusters are driven by biological pathway definitions
- **FAIL**: Random gene groupings produce similar results

#### Stability Test: Bootstrap

Resamples the data with replacement 50 times and re-runs clustering. Stable clusters should be recovered across bootstrap samples (high ARI). If clustering is unstable, it suggests the clusters are not robust features of the data.

- **Metric**: `mean_bootstrap_ARI` (average ARI across 50 bootstrap samples)
- **Threshold**: ≥ 0.8
- **PASS**: Clusters are stable and reproducible
- **FAIL**: Clusters are sensitive to sample composition

### Interpreting Validation Gate Results

| Result | Interpretation | Action |
|--------|----------------|--------|
| **All PASS** | Clusters have passed basic sanity checks | Proceed with caution, still requires biological validation |
| **NC1 FAIL** | Clustering may be finding artifacts | Review method parameters, consider different clustering approach |
| **NC2 FAIL** | Pathways may not be driving clusters | Verify pathway database quality, consider gene-level analysis |
| **Stability FAIL** | Clusters are not robust | Increase sample size, reduce cluster count, or accept higher uncertainty |

### Important Caveats

- **PASS does not mean biologically valid**: Validation gates only check statistical properties
- **FAIL does not mean results are useless**: Results may still be informative for hypothesis generation
- **Demo data limitations**: The synthetic demo dataset may not pass all gates due to limited sample size

---

## Interpretation Guardrails

### Required Context for Any Finding

1. **Cohort context**: Results are relative to the analyzed cohort
2. **Pathway database version**: Different databases yield different results
3. **Parameter choices**: Clustering parameters affect subtype boundaries
4. **Statistical uncertainty**: Confidence intervals should always be considered

### Validation Requirements Before Any Claim

| Claim Type | Required Validation |
|------------|---------------------|
| "Subtype X exists" | Replication in independent cohort |
| "Pathway Y is disrupted" | Functional validation (cellular/animal) |
| "Gene Z contributes" | Segregation analysis, functional assays |
| "Treatment implication" | Clinical trial |

### Confidence Thresholds

| Metric | Threshold | Interpretation |
|--------|-----------|----------------|
| ARI (vs ground truth) | >0.7 | Acceptable cluster recovery |
| Silhouette score | >0.5 | Reasonable cluster separation |
| Bootstrap stability (ARI) | ≥0.8 | Stable cluster assignments |
| Label shuffle null ARI | <0.15 | No spurious patterns |
| Random gene sets ARI | <0.15 | Pathways drive clustering |
| Confidence score | >0.9 | High-confidence assignment |

---

## What NOT to Infer

### Clinical Decisions

> **NEVER use these outputs for:**
> - Diagnosis of autism or any condition
> - Treatment selection or modification
> - Genetic counseling without clinical validation
> - Insurance or legal decisions
> - Any decision affecting patient care

### Causal Claims

> **These outputs do NOT establish:**
> - That a pathway causes autism
> - That a gene is pathogenic
> - That subtypes have different prognoses
> - That interventions targeting pathways would help

### Generalization

> **Results may NOT generalize to:**
> - Other cohorts with different demographics
> - Individuals not in the analyzed cohort
> - Future patients
> - Different ancestral backgrounds

---

## Responsible Use Checklist

Before sharing or publishing results, verify:

- [ ] Disclaimer is prominently displayed
- [ ] Limitations are clearly stated
- [ ] Results are described as "hypothesis-generating"
- [ ] No clinical recommendations are made
- [ ] Validation requirements are acknowledged
- [ ] Cohort context is provided
- [ ] Statistical uncertainty is reported

---

## Questions?

If you're unsure how to interpret an output, **do not guess**. Contact the development team or consult a biostatistician with genomics expertise.

---

*Last updated: 2026-01-27 | Autism Pathway Framework v0.1*
